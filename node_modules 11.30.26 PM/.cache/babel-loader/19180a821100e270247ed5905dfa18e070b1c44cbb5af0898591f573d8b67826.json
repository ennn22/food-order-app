{"ast":null,"code":"import _defineProperty from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Box,Button,TextField}from\"@mui/material\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useItemContext}from\"../Store/ItemsProvider.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var apiKey=process.env.REACT_APP_API_KEY;var AdminForm=function AdminForm(_ref){var hideAddItemForm=_ref.hideAddItemForm;var _useItemContext=useItemContext(),addNewItem=_useItemContext.addNewItem,updateItem=_useItemContext.updateItem,editableItem=_useItemContext.editableItem;var apiUrl=\"https://api.imgbb.com/1/upload?&key=\".concat(apiKey);var _useState=useState({name:\"\",desc:\"\",price:\"\",img:\"\"}),_useState2=_slicedToArray(_useState,2),inputFields=_useState2[0],setInputFields=_useState2[1];var handleInputChanges=function handleInputChanges(e){setInputFields(function(previousItem){return _objectSpread(_objectSpread({},previousItem),{},_defineProperty({},e.target.name,e.target.value));});};var uploadFile=function uploadFile(data,callback){console.log(data);var fileInput=new FormData();fileInput.append('image',data);axios.post(apiUrl,fileInput).then(function(res){callback({img:res.data.data.url});}).catch(function(err){console.log(err);});};var fileInput=document.querySelector('#file-input');var handleSubmit=function handleSubmit(e){e.preventDefault();if(editableItem){submitEditForm();}else{submitNewForm();};};var submitEditForm=function submitEditForm(){if(fileInput.files[0]){uploadFile(fileInput.files[0],function(img){updateItem(_objectSpread(_objectSpread(_objectSpread({},inputFields),img),{},{id:editableItem.id}));});}else{updateItem(_objectSpread(_objectSpread({},inputFields),{},{id:editableItem.id}));}resetForm();};var submitNewForm=function submitNewForm(){uploadFile(fileInput.files[0],function(img){addNewItem(_objectSpread(_objectSpread({},inputFields),img));resetForm();});};var resetForm=function resetForm(){hideAddItemForm();setInputFields({name:\"\",desc:\"\",price:\"\",img:\"\"});fileInput.value=\"\";};// useEffect(() => {\n//   console.log(inputFields)\n// }, [inputFields])\n// const [newItem, setNewItem] = useState({name:\"\", desc:\"\", price:\"\", img: \"\"});\n//handle text input from admin form except file\n// const handleInput = (e) => {\n//   const { name, value } = e.target;\n//   setNewItem((previousItem) => ({\n//     ...previousItem, [name]: value\n//   })) \n// };\n//upload image from local and get url\n// const uploadFile = (data) => {\n//   const fileInput = new FormData();\n//   fileInput.append('image', data);\n//   axios.post(apiUrl, fileInput)\n//     .then((res) => {\n//     setNewItem((previousItem) => ({\n//       ...previousItem, img: res.data.data.url\n//     }))\n//     })\n//     .catch((err) => {\n//     console.log(err);\n//     });\n// }\n//handle submit of file\n// const handleSubmit = (e) => {\n//   e.preventDefault();\n//   uploadFile(fileInput.files[0]);\n// }\n//add new item \n// useEffect(() => {\n//   if (newItem.img !== \"\") {\n//     addNewItem(newItem);\n//     setNewItem({name:\"\", desc:\"\", price:\"\", img: \"\"});\n//     fileInput.value = \"\";\n//   }\n// }, [newItem.img]);\nuseEffect(function(){if(editableItem){setInputFields(editableItem);}},[editableItem]);return/*#__PURE__*/_jsx(Box,{className:\"admin-form-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,autoComplete:\"off\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-form-input\",children:[/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,size:\"small\",margin:\"dense\",variant:\"outlined\",id:\"food-name\",label:\"Name\",name:\"name\",type:\"text\",inputProps:{maxLength:20},value:inputFields.name,onChange:handleInputChanges// onChange={(e)=> {handleInputChanges()}}\n// onChange={handleInput}\n}),/*#__PURE__*/_jsx(TextField,{sx:{backgroundColor:\"#F6F1EE\"},required:true,fullWidth:true,multiline:true,size:\"small\",margin:\"dense\",variant:\"outlined\",id:\"food-desc\",label:\"Description\",name:\"desc\",type:\"text\",inputProps:{maxLength:130},value:inputFields.desc,onChange:handleInputChanges// onChange={(e)=> {handleInputChanges()}}\n// onChange={handleInput}\n}),/*#__PURE__*/_jsx(TextField,{required:true,fullWidth:true,size:\"small\",margin:\"dense\",variant:\"outlined\",id:\"food-price\",label:\"Price\",name:\"price\",type:\"number\",placeholder:\"RM 0.00\",inputProps:{step:0.1,min:0,max:200},value:inputFields.price,onChange:handleInputChanges// onChange={(e)=> {handleInputChanges()}}\n// onChange={handleInput}\n})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-form-upload\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file-input\"}),/*#__PURE__*/_jsx(\"input\",{required:!editableItem,id:\"file-input\",type:\"file\",name:\"img\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-form-btn\",children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",size:\"small\",variant:\"contained\",color:\"success\",children:\"Submit\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"small\",color:\"error\",onClick:hideAddItemForm,children:\"Cancel\"})]})]})});};export default AdminForm;","map":{"version":3,"names":["Box","Button","TextField","axios","useEffect","useState","useItemContext","jsx","_jsx","jsxs","_jsxs","apiKey","process","env","REACT_APP_API_KEY","AdminForm","_ref","hideAddItemForm","_useItemContext","addNewItem","updateItem","editableItem","apiUrl","concat","_useState","name","desc","price","img","_useState2","_slicedToArray","inputFields","setInputFields","handleInputChanges","e","previousItem","_objectSpread","_defineProperty","target","value","uploadFile","data","callback","console","log","fileInput","FormData","append","post","then","res","url","catch","err","document","querySelector","handleSubmit","preventDefault","submitEditForm","submitNewForm","files","id","resetForm","className","children","onSubmit","autoComplete","required","fullWidth","size","margin","variant","label","type","inputProps","maxLength","onChange","sx","backgroundColor","multiline","placeholder","step","min","max","htmlFor","color","onClick"],"sources":["/Users/ying/Code/react-practiculum-2/food-order-app/src/Components/AdminForm.js"],"sourcesContent":["import { Box, Button, TextField } from \"@mui/material\";\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { useItemContext } from \"../Store/ItemsProvider.js\";\n\nconst apiKey = process.env.REACT_APP_API_KEY;\n\nconst AdminForm = ({ hideAddItemForm }) => {\n  const { addNewItem, updateItem, editableItem } = useItemContext();\n\n  const apiUrl = `https://api.imgbb.com/1/upload?&key=${apiKey}`;\n\n  const [inputFields, setInputFields] = useState({\n    name:\"\", desc:\"\", price:\"\", img: \"\"\n  });\n\n  const handleInputChanges = (e) => {\n    setInputFields((previousItem) => {\n      return {\n        ...previousItem,\n        [e.target.name]: e.target.value\n      }\n    })\n  }\n  \n  const uploadFile = (data, callback) => {\n    console.log(data)\n    const fileInput = new FormData();\n    fileInput.append('image', data);\n\n    axios.post(apiUrl, fileInput)\n      .then(\n        (res) => {\n          callback({\n            img: res.data.data.url\n          });\n        })\n      .catch(\n        (err) => {\n          console.log(err);\n        }\n      );\n  }\n\n  const fileInput = document.querySelector('#file-input');\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (editableItem) {\n      submitEditForm()\n    } else {\n      submitNewForm()\n    };\n  };\n\n  const submitEditForm = () => {\n    if (fileInput.files[0]) {\n      uploadFile(fileInput.files[0], (img) => {\n        updateItem({\n          ...inputFields,\n          ...img, \n          id: editableItem.id\n        })\n      });\n    } else {\n      updateItem({\n        ...inputFields,\n        id: editableItem.id\n      })\n    }\n    resetForm();\n  } \n\n  const submitNewForm = () => {\n    uploadFile(fileInput.files[0], (img) => {\n      addNewItem({\n        ...inputFields,\n        ...img\n      });\n      resetForm();\n    });\n  }\n\n  const resetForm = () => {\n    hideAddItemForm();\n    setInputFields({ name: \"\", desc: \"\", price: \"\", img: \"\"});\n    fileInput.value = \"\";\n  }\n\n  // useEffect(() => {\n  //   console.log(inputFields)\n  // }, [inputFields])\n\n  // const [newItem, setNewItem] = useState({name:\"\", desc:\"\", price:\"\", img: \"\"});\n\n  //handle text input from admin form except file\n  // const handleInput = (e) => {\n  //   const { name, value } = e.target;\n  //   setNewItem((previousItem) => ({\n  //     ...previousItem, [name]: value\n  //   })) \n  // };\n\n  //upload image from local and get url\n  // const uploadFile = (data) => {\n  //   const fileInput = new FormData();\n  //   fileInput.append('image', data);\n  //   axios.post(apiUrl, fileInput)\n  //     .then((res) => {\n  //     setNewItem((previousItem) => ({\n  //       ...previousItem, img: res.data.data.url\n  //     }))\n  //     })\n  //     .catch((err) => {\n  //     console.log(err);\n  //     });\n  // }\n\n  //handle submit of file\n  // const handleSubmit = (e) => {\n  //   e.preventDefault();\n  //   uploadFile(fileInput.files[0]);\n  // }\n    \n  //add new item \n  // useEffect(() => {\n  //   if (newItem.img !== \"\") {\n  //     addNewItem(newItem);\n  //     setNewItem({name:\"\", desc:\"\", price:\"\", img: \"\"});\n  //     fileInput.value = \"\";\n  //   }\n  // }, [newItem.img]);\n\n  useEffect(() => {\n    if (editableItem) {\n\n      setInputFields(editableItem)\n    }\n  }, [editableItem])\n\n  return (\n    <Box className=\"admin-form-container\"> \n      <form onSubmit={handleSubmit} autoComplete=\"off\">\n        <div className=\"admin-form-input\">\n          <TextField\n            required\n            fullWidth\n            size=\"small\"\n            margin=\"dense\"\n            variant=\"outlined\"\n            id=\"food-name\"\n            label=\"Name\"\n            name=\"name\"\n            type=\"text\"\n            inputProps={{maxLength: 20}}\n            value={inputFields.name}\n            onChange={handleInputChanges}\n            // onChange={(e)=> {handleInputChanges()}}\n            // onChange={handleInput}\n          /> \n          <TextField\n            sx= {{ backgroundColor: \"#F6F1EE\" }}\n            required\n            fullWidth\n            multiline\n            size=\"small\"\n            margin=\"dense\"\n            variant=\"outlined\"\n            id=\"food-desc\"\n            label=\"Description\"\n            name=\"desc\"\n            type=\"text\"\n            inputProps={{maxLength: 130}}\n            value={inputFields.desc}\n            onChange={handleInputChanges}\n            // onChange={(e)=> {handleInputChanges()}}\n            // onChange={handleInput}\n          /> \n          <TextField\n            required\n            fullWidth\n            size=\"small\"\n            margin=\"dense\"\n            variant=\"outlined\"\n            id=\"food-price\"\n            label=\"Price\"\n            name=\"price\"\n            type=\"number\"\n            placeholder=\"RM 0.00\"\n            inputProps={{\n              step: 0.1,\n              min: 0,\n              max: 200\n            }}\n            value={inputFields.price}\n            onChange={handleInputChanges}\n            // onChange={(e)=> {handleInputChanges()}}\n            // onChange={handleInput}\n          />\n        </div>\n        <div className=\"admin-form-upload\">\n            <label htmlFor=\"file-input\"></label>\n            <input required={!editableItem} id=\"file-input\" type=\"file\" name=\"img\"/>\n        </div>\n        <div className=\"admin-form-btn\">\n          <Button type=\"submit\" size=\"small\" variant=\"contained\" color=\"success\">\n            Submit\n          </Button>\n          <Button variant=\"contained\" size=\"small\" color=\"error\" onClick={hideAddItemForm}>\n            Cancel\n          </Button>\n        </div>\n      </form>\n    </Box>\n  )\n}\n\nexport default AdminForm;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}