{"ast":null,"code":"import _toConsumableArray from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _defineProperty from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/ying/Code/react-practiculum-2/food-order-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Cart from\"../Components/Cart\";import CartContext from'./CartContext';import{useItemContext}from\"./ItemsProvider.js\";import{useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export function useCartContext(){return useContext(CartContext);}var CartProvider=function CartProvider(_ref){var children=_ref.children;var _useItemContext=useItemContext(),itemsData=_useItemContext.itemsData;var LOCAL_STORAGE_KEY=\"cart-items\";var localStorageCartQty=localStorage.getItem(LOCAL_STORAGE_KEY);var lsCartParse=localStorageCartQty?JSON.parse(localStorageCartQty):{};var cartItemsData=itemsData.filter(function(item){return Object.keys(lsCartParse).includes(item.name);});var _useState=useState(cartItemsData),_useState2=_slicedToArray(_useState,2),cartItems=_useState2[0],setCartItems=_useState2[1];// const [cartItems, setCartItems] = useState(() => {\n//   return Object.keys(lsCartParse).map((cart) => {\n//     return itemsData.find(i => i.name === cart)\n//   })\n// });\nvar _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),totalAmount=_useState4[0],setTotalAmount=_useState4[1];var _useState5=useState(lsCartParse),_useState6=_slicedToArray(_useState5,2),qty=_useState6[0],setQty=_useState6[1];useEffect(function(){localStorage.setItem(LOCAL_STORAGE_KEY,JSON.stringify(qty));var newTotalAmount=cartItems.reduce(function(total,item){return qty[item.name]*item.price+total;},0);setTotalAmount(newTotalAmount);},[qty]);//Add item to cart\nvar addItemToCart=function addItemToCart(item){var inCartItemIndex=cartItems.findIndex(function(cartItem){return cartItem.id===item.id;});var inCartItem=cartItems[inCartItemIndex];if(inCartItem){setQty(_objectSpread(_objectSpread({},qty),{},_defineProperty({},item.name,qty[item.name]+1)));}else{setQty(_objectSpread(_objectSpread({},qty),{},_defineProperty({},item.name,1)));setCartItems([].concat(_toConsumableArray(cartItems),[item]));}};//Remove item from cart \nvar removeItemFromCart=function removeItemFromCart(item){var updatedCartItems=cartItems.filter(function(cartItem){return cartItem.id!==item.id;});setCartItems(updatedCartItems);};var handleAdd=function handleAdd(item){setQty(_objectSpread(_objectSpread({},qty),{},_defineProperty({},item.name,qty[item.name]+1)));};var handleRemove=function handleRemove(item){if(qty[item.name]===1){removeItemFromCart(item);}else{setQty(_objectSpread(_objectSpread({},qty),{},_defineProperty({},item.name,qty[item.name]-1)));}};var clearAll=function clearAll(item){setCartItems([]);setTotalAmount(0);};var cartCtxValue={cartItems:cartItems,totalAmount:totalAmount,qty:qty,addItem:addItemToCart,handleAdd:handleAdd,handleRemove:handleRemove,clearAll:clearAll};return/*#__PURE__*/_jsx(CartContext.Provider,{value:cartCtxValue,children:children});};export default CartProvider;","map":{"version":3,"names":["Cart","CartContext","useItemContext","useContext","useEffect","useState","jsx","_jsx","useCartContext","CartProvider","_ref","children","_useItemContext","itemsData","LOCAL_STORAGE_KEY","localStorageCartQty","localStorage","getItem","lsCartParse","JSON","parse","cartItemsData","filter","item","Object","keys","includes","name","_useState","_useState2","_slicedToArray","cartItems","setCartItems","_useState3","_useState4","totalAmount","setTotalAmount","_useState5","_useState6","qty","setQty","setItem","stringify","newTotalAmount","reduce","total","price","addItemToCart","inCartItemIndex","findIndex","cartItem","id","inCartItem","_objectSpread","_defineProperty","concat","_toConsumableArray","removeItemFromCart","updatedCartItems","handleAdd","handleRemove","clearAll","cartCtxValue","addItem","Provider","value"],"sources":["/Users/ying/Code/react-practiculum-2/food-order-app/src/Store/CartProvider.js"],"sourcesContent":["import Cart from \"../Components/Cart\"\nimport CartContext from './CartContext'\nimport { useItemContext } from \"./ItemsProvider.js\";\nimport { useContext, useEffect, useState } from 'react';\n\nexport function useCartContext() {\n  return useContext(CartContext);\n}\n\nconst CartProvider = ({ children }) => {\n  const { itemsData } = useItemContext();\n  const LOCAL_STORAGE_KEY = \"cart-items\";\n  const localStorageCartQty = localStorage.getItem(LOCAL_STORAGE_KEY);\n  const lsCartParse = localStorageCartQty ? JSON.parse(localStorageCartQty) : {};\n\n  const cartItemsData = itemsData.filter((item) => {\n    return Object.keys(lsCartParse).includes(item.name);\n  })\n\n  const [cartItems, setCartItems] = useState(cartItemsData);\n\n  // const [cartItems, setCartItems] = useState(() => {\n  //   return Object.keys(lsCartParse).map((cart) => {\n  //     return itemsData.find(i => i.name === cart)\n  //   })\n  // });\n  const [totalAmount, setTotalAmount] = useState(0);\n  const [qty, setQty] = useState(lsCartParse);\n\n  useEffect(() => {\n    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(qty));\n    const newTotalAmount = cartItems.reduce((total, item) => {\n      return (qty[item.name] * item.price) + total;\n    }, 0)\n    setTotalAmount(newTotalAmount);\n  }, [qty])\n\n  //Add item to cart\n  const addItemToCart = (item) => {\n    const inCartItemIndex = cartItems.findIndex((cartItem) => cartItem.id === item.id);\n    const inCartItem = cartItems[inCartItemIndex];\n    if (inCartItem) {\n      setQty({\n        ...qty,\n        [item.name]: qty[item.name] + 1\n      });\n    } else {\n      setQty({\n        ...qty,\n        [item.name]: 1\n      });\n      setCartItems([...cartItems, item]);\n    }\n  };\n\n  //Remove item from cart \n  const removeItemFromCart = (item) => {\n    const updatedCartItems = cartItems.filter((cartItem) => {\n      return cartItem.id !== item.id;\n    });\n    setCartItems(updatedCartItems);\n  }\n\n  const handleAdd = (item) => {\n    setQty({\n      ...qty,\n      [item.name]: qty[item.name] + 1\n    })\n  }\n\n  const handleRemove = (item) => {\n    if (qty[item.name] === 1) {\n      removeItemFromCart(item);\n    } else {\n      setQty({\n        ...qty,\n        [item.name]: qty[item.name] - 1\n      })\n    }\n  }\n\n  const clearAll = (item) => {\n    setCartItems([]);\n    setTotalAmount(0);\n  }\n\n  const cartCtxValue = {\n    cartItems,\n    totalAmount,\n    qty,\n    addItem: addItemToCart,\n    handleAdd,\n    handleRemove,\n    clearAll\n  };\n\n  return (\n    <CartContext.Provider value={cartCtxValue}>\n      { children }\n    </CartContext.Provider>\n  )\n}\nexport default CartProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}